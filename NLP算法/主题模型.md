## 主题模型

- NLP-机器学习笔试面试题解析 [Github链接](https://github.com/WerterHong/Machine-Learning-Algorithm-NLP/)
- **主题模型** (若公式显示错误，请点击此链接) [有道云笔记](http://note.youdao.com/noteshare?id=b68e61b9fa9321cee59f807071b5bfc5&sub=8EB569F05E804E418752C7C217DA943B)

### 1. 背景知识

> ==`Gamma`函数、`Beta`分布、`Dirichlet`分布推导见==：[LDA数学八卦](http://www.52nlp.cn/lda-math-%e8%ae%a4%e8%af%86betadirichlet%e5%88%86%e5%b8%831)。

#### 1.0 Gamma 函数

当`n`为整数时，`n`的阶乘定义为`n!=n *(n-1) *(n-2) * ...  * 2 * 1`。当`n`不是整数时，`n`的阶乘是多少？

`Gamma`函数的基本公式如下：

```math
\Gamma(x)=\int_{0}^{\infty} t^{x-1} e^{-t} d t
```
Gamma函数图像如下：

<p align="center">
<img src="https://note.youdao.com/yws/public/resource/b68e61b9fa9321cee59f807071b5bfc5/4ABE7DAC8BDA4CF0B334FEDD1C69B131?ynotemdtimestamp=1564394744465" />
</p>

<p align="center">
<strong>Fig</strong>. Gamma 函数
</p>

Gamma函数有如下性质：
1. ==递归性质==（利用分步积分法可证）

```math
\Gamma(x+1)=x \Gamma(x)
```

2. 可表述为==阶乘在实数集上的拓展==

```math
\Gamma(n)=(n-1) !
```

> Q: 为何定义`Γ`函数的时候，不使得这个函数的定义满足`Γ(n)=n!`而是`Γ(n)=(n−1)!` ？
>
> A: 将`Gamma`函数定义中的`$t^{x−1}$`替换为`$t^x$`，即
```math
\Gamma(x)=\int_{0}^{\infty} t^{x} e^{-t} d t
```
> 可得`$\Gamma(n)=n !$`
>
> 定义如下积分（==`Beta`函数==）
```math
B(m, n)=\int_{0}^{1} x^{m-1}(1-x)^{n-1} d x
```
> 如果满足`$\Gamma(n)=(n-1) !$`，那么有
```math
B(m, n)=\frac{\Gamma(m) \Gamma(n)}{\Gamma(m+n)}
```
> 如果满足`$\Gamma(n)=n !$`，令
```math
E(m, n)=\int_{0}^{1} x^{m}(1-x)^{n} d x
```
> 则有
```math
E(m, n)=\frac{\Gamma(m) \Gamma(n)}{\Gamma(m+n+1)}
```
> 不如`B(m,n)`优美。



#### 1.1 二项分布

**伯努利分布**，又称两点分布或`0-1`分布，是一个==离散型的随机分布==，其中的随机变量只有两类取值，非正即负`{+，-}`。

**二项分布**即==重复`n`次的伯努利试验==，记为`X~(b(n,p))`。二项分布的概率密度函数为：

```math
P(K=k)=\left(\begin{array}{l}{n} \\ {k}\end{array}\right) p^{k}(1-p)^{n-k} = \frac{n!}{k!(n-k)!} \times p^{k}(1-p)^{n-k}, \quad k=0,1,...,n
```
其中`$\left(\begin{array}{l}{n} \\ {k}\end{array}\right)=\frac{n!}{k!(n-k)!}$`是==二项系数==，又记为`C(n,k)`。

#### 1.2 多项分布

**多项分布**是二项分布扩展到多维的情况，是指单次试验中的随机变量取值不再是`0-1`的，而是有==多种离散值的可能==`(1,2,3,...,k)`。比如投掷骰子实验，`N`次实验结果服从`k=6`的多项分布。其中

```math
\sum_{i=1}^{k} p_{i}=1, p_{i}>0
```
多项分布的概率密度函数为：

```math
P\left(x_{1}, x_{2}, \ldots, x_{k} ; n, p_{1}, p_{2}, \ldots, p_{k}\right)=\frac{n !}{x_{1} ! \cdots x_{k} !} p_{1}^{x_{1}} \cdots p_{k}^{x_{k}}
```

>  **共轭先验分布**：在贝叶斯概率理论中，如果后验概率`P(θ|x)`和先验概率`p(θ)`满足==同样的分布律==，那么，先验分布和后验分布被叫做==共轭分布==，同时，先验分布叫做==似然函数的共轭先验分布==。

> ==贝叶斯框架==的固定模式：

```math
先验分布\pi(\theta) + 样本信息\chi \Rightarrow 后验分布{\pi}(\theta | x)
```


#### 1.3 Beta 分布

`Beta`分布是指一组分布在`[0,1]`区间的==连续概率分布==，其中参数为`α>0`，`β>0`，概率密度函数为：

```math
f(x ; \alpha, \beta)=\frac{1}{B(\alpha, \beta)} x^{\alpha-1}(1-x)^{\beta-1}
```
其中

```math
\frac{1}{B(\alpha, \beta)}=\frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha) \Gamma(\beta)}, \quad \Gamma(x)=\int_{0}^{\infty} t^{x-1} e^{-t} d t
```

`α,β`不同取值的`Beta`分布如下图：

<p align="center">
<img src="https://note.youdao.com/yws/public/resource/b68e61b9fa9321cee59f807071b5bfc5/E7904C86A9424647BEACD8647B5CFBA8?ynotemdtimestamp=1564394744465" width=500 />
</p>

<p align="center">
<strong>Fig</strong>. 不同取值的Beta分布
</p>

> 如果二项分布的参数`p`选取的先验分布是`Beta`分布，那么以`p`为参数的二项分布用==贝叶斯估计==得到的后验分布仍然服从`Beta`分布，那么`Beta`分布就是==二项分布的共轭先验分布==(`Beta-Binomial`共轭)，用数学公式表述就是：

```math
\operatorname{Beta}(p | \alpha, \beta)+\operatorname{BinomCount}\left(m_{1}, m_{2}\right)=\operatorname{Beta}\left(p | \alpha+m_{1}, \beta+m_{2}\right)
```
- 如果`p∼Beta(t|α,β)`, `Beta`分布的==期望==为：

```math
E(p)=\frac{\alpha}{\alpha+\beta}
```

#### 1.4 Dirichlet 分布

**Dirichlet 分布**是`Beta`分布在高纬度上的推广。 Dirichlet分布的的密度函数为：

```math
f\left(x_{1}, x_{2}, \ldots, x_{k} ; \alpha_{1}, \alpha_{2}, \ldots, \alpha_{k}\right)=\frac{1}{B(\alpha)} \prod_{i=1}^{k} x_{i}^{\alpha^{i}-1}
```
其中

```math
B(\alpha)=\frac{\prod_{i=1}^{k} \Gamma\left(\alpha^{i}\right)}{\Gamma\left(\sum_{i=1}^{k} \alpha^{i}\right)}, \quad \sum_{i=1}^{k} x^{i}=1
```

不同`α`下的`Dirichlet`分布如下图：

<p align="center">
<img src="https://note.youdao.com/yws/public/resource/b68e61b9fa9321cee59f807071b5bfc5/79E5EDD91E7A42B69722F5007EC20B70?ynotemdtimestamp=1564394744465" width=500 />
</p>

<p align="center">
<strong>Fig</strong>. 不同 α 下的 Dirichlet 分布
</p>

> 且类比于Beta分布，Dirichlet也是==多项分布的共轭先验分布==(`Dirichlet-Multinomial`共轭)：

```math
Dirichlet(\vec{p} | \vec{\alpha})+MultiCount(\vec{m})=Dirichlet(\vec{p} | \vec{\alpha}+\vec{m})
```
- `Dirichlet`分布的==期望==如下：

```math
E(p)=\left(\frac{\alpha^{1}}{\sum_{i=1}^{K} \alpha_{i}}, \frac{\alpha^{2}}{\sum_{i=1}^{K} \alpha_{i}}, \cdots, \frac{\alpha^{K}}{\sum_{i=1}^{K} \alpha_{i}}\right)
```
其**物理意义**也就是每个参数的估计值是==其对应事件的先验的参数和数据中的计数的和==在整体计数中的比例。

#### 1.5 分布之间的联系

> - 二项分布和多项分布很相似，`Beta`分布和`Dirichlet`分布很相似
>
> - `Beta`分布是二项式分布的共轭先验概率分布，而`Dirichlet`分布是多项式分布的共轭先验概率分布

### 2. pLSA 模型

### 3. LDA 模型

### 4. NMF
